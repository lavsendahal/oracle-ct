# @package _global_

# 3D ResNet MaskedUnaryAttnScalar experiment: OracleCT_ResNet3D_MaskedUnaryAttnScalar
# Organ-guided 3D masked attention + direct scalar fusion (TriageNet-style)
#
# Architecture:
#   visual [B, D]  (f3 + f4 pyramid, e.g. 3072 for resnet152)
#   scalars [B, S]  (mean_hu + to_body_ratio + touches_border per organ)
#   → cat [B, D+S]
#   → LayerNorm → Linear(D+S → scalar_hidden) → ReLU → Linear(scalar_hidden → 1)

model:
  name: OracleCT_ResNet3D_MaskedUnaryAttnScalar
  backbone: resnet152
  pretrained: true
  use_checkpoint: true
  num_diseases: 30
  disease_names: null
  freeze_backbone: false
  learn_tau: true
  init_tau: 0.7
  use_mask_bias: true
  init_inside: 0.8
  init_outside: 0.2
  scalar_hidden: 256          # fusion MLP hidden dim
  feature_stats_path: ${paths.feature_stats}

training:
  max_epochs: 20

logging:
  use_wandb: false
